<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<script>
    // --- GLOBAL VARIABLES ---
    let scene, camera, renderer, controlledObject;
    let targetRotationX = 0;
    let targetRotationY = 0;

    // --- THREE.JS SETUP ---
    function initThreeJS() {
        const canvasContainer = document.getElementById('webgl-canvas');
        
        // 1. Scene Setup
        scene = new THREE.Scene();
        
        // 2. Camera Setup
        camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;
        
        // 3. Renderer Setup
        renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        canvasContainer.appendChild(renderer.domElement);

        // --- NEW ELEMENT 1: The Central Neon Globe (Your Model) ---
        const geometry = new THREE.SphereGeometry(1.5, 64, 64); // High-resolution sphere
        // Use a glowing, wireframe-style material for a supercluster/planet effect
        const material = new THREE.MeshLambertMaterial({ 
            color: 0x00ffcc,           // Neon cyan color
            emissive: 0x00ffcc,        // Causes the object to glow
            emissiveIntensity: 0.5,    // Set glow strength
            wireframe: true            // Creates a futuristic grid look
        });
        controlledObject = new THREE.Mesh(geometry, material);
        scene.add(controlledObject);

        // --- NEW ELEMENT 2: Lighting and Environment ---
        // Ambient light for general brightness
        scene.add(new THREE.AmbientLight(0xffffff, 0.1)); 

        // Point light (acts as the core of the supercluster)
        const pointLight = new THREE.PointLight(0x00ffaa, 2, 100); 
        pointLight.position.set(0, 0, 0); // Center of the sphere
        scene.add(pointLight);

        // --- NEW ELEMENT 3: Starfield Background (A simple, code-generated background) ---
        const starsGeometry = new THREE.BufferGeometry();
        const starsCount = 5000;
        const positions = [];

        for (let i = 0; i < starsCount; i++) {
            // Generate random positions far away from the center
            positions.push((Math.random() - 0.5) * 200); 
            positions.push((Math.random() - 0.5) * 200);
            positions.push((Math.random() - 0.5) * 200);
        }
        starsGeometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));

        const starsMaterial = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 0.15,
            sizeAttenuation: true
        });

        const starField = new THREE.Points(starsGeometry, starsMaterial);
        scene.add(starField);

        window.addEventListener('resize', onWindowResize, false);
        document.addEventListener('mousemove', onDocumentMouseMove, false);
    }

    function onWindowResize() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    }

    function onDocumentMouseMove(event) {
        // Normalize mouse positions
        targetRotationY = (event.clientX / window.innerWidth) * 2 - 1;
        targetRotationX = (event.clientY / window.innerHeight) * 2 - 1;
    }

    // --- ANIMATION LOOP ---
    function animate() {
        requestAnimationFrame(animate);

        // Apply smooth rotation to the central object
        if (controlledObject) {
            controlledObject.rotation.y += (targetRotationY * Math.PI - controlledObject.rotation.y) * 0.05;
            controlledObject.rotation.x += (targetRotationX * Math.PI * 0.5 - controlledObject.rotation.x) * 0.05;
        }

        renderer.render(scene, camera);
    }

    // --- INITIALIZATION ---
    function run() {
        initThreeJS();
        animate();
    }

    run();
</script>
